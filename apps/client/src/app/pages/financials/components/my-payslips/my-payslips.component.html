<ion-header class="premium-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="navigationService.toggleSidebar()">
        <ion-icon name="menu-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    
    <ion-title>
      <div class="header-title-stack">
        <span>My Payslips</span>
        <span>Earnings History</span>
      </div>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="page-background">
  <ion-refresher slot="fixed" (ionRefresh)="loadPayslips($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  @if (financialsService.myPayslipsStatus() === 'loading') {
    <div class="centered-container">
      <ion-spinner name="crescent"></ion-spinner>
    </div>
  } @else if (financialsService.myPayslipsStatus() === 'error') {
    <div class="centered-container ion-padding ion-text-center">
      <ion-label color="danger">Failed to load payslips.</ion-label>
      <ion-button (click)="loadPayslips()" fill="outline" class="ion-margin-top">Retry</ion-button>
    </div>
  } @else {
    <div class="page-container ion-padding-top">
      <div class="list-wrapper">
        @for (slip of financialsService.myPayslips(); track slip.id) {
          
          <div class="compact-ticket" (click)="viewPayslipDetails(slip.id)">
            <div class="date-box">
              <span class="month">{{ slip.payPeriod | date:'MMM' | uppercase }}</span>
              <span class="year">{{ slip.payPeriod | date:'yy' }}</span>
            </div>

            <div class="ticket-body">
              <div class="top-row">
                <span class="period-text">{{ slip.payPeriod | date:'MMMM yyyy' }}</span>
                <span class="status-dot" [class]="slip.status.toLowerCase()"></span>
              </div>
              <div class="bottom-row">
                <span class="status-label">{{ slip.status }}</span>
              </div>
            </div>

            <div class="ticket-end">
              <span class="amount">â‚¦{{ slip.netSalary.toLocaleString('en-NG', { minimumFractionDigits: 0, maximumFractionDigits: 0 }) }}</span>
              <ion-icon name="chevron-forward" color="medium"></ion-icon>
            </div>
          </div>

        } @empty {
          <div class="empty-state">
            <ion-icon name="document-text-outline"></ion-icon>
            <h3>No Payslips</h3>
            <p>History is empty.</p>
          </div>
        }
      </div>
    </div>
  }
</ion-content>